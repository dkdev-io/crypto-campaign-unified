#!/bin/bash

# Project Status Checker
# Creates comprehensive status report for crypto-campaign-unified

echo "ðŸš€ CRYPTO CAMPAIGN PROJECT STATUS"
echo "================================="
echo ""

# Check current directory
echo "ðŸ“ CURRENT LOCATION:"
pwd
if [[ $(pwd) == *"crypto-campaign-unified/crypto-campaign-unified"* ]]; then
    echo "âš ï¸  WARNING: You're in a subdirectory!"
    echo "   Run: cd /Users/Danallovertheplace/crypto-campaign-unified"
fi
echo ""

# Check project structure
echo "ðŸ“ PROJECT STRUCTURE:"
cd /Users/Danallovertheplace/crypto-campaign-unified 2>/dev/null || {
    echo "âŒ Cannot find project root!"
    exit 1
}

for dir in frontend backend contracts; do
    if [ -d "$dir" ]; then
        echo "âœ… $dir/ - $(cat $dir/package.json 2>/dev/null | grep '"name"' | cut -d'"' -f4)"
    else
        echo "âŒ $dir/ - MISSING"
    fi
done
echo ""

# Check running services
echo "ðŸ”Œ RUNNING SERVICES:"
frontend_port=$(lsof -i :5173 2>/dev/null | grep LISTEN | wc -l)
backend_port=$(lsof -i :3000 2>/dev/null | grep LISTEN | wc -l)
hardhat_port=$(lsof -i :8545 2>/dev/null | grep LISTEN | wc -l)

if [ $frontend_port -gt 0 ]; then
    echo "âœ… Frontend: http://localhost:5173"
else
    echo "â­• Frontend: Not running"
fi

if [ $backend_port -gt 0 ]; then
    echo "âœ… Backend: http://localhost:3000"
else
    echo "â­• Backend: Not running"
fi

if [ $hardhat_port -gt 0 ]; then
    echo "âœ… Hardhat: http://localhost:8545"
else
    echo "â­• Hardhat: Not running"
fi
echo ""

# Check deployment
echo "ðŸŒ DEPLOYMENT STATUS:"
echo "Live Site: https://cryptocampaign.netlify.app"
echo "Last Deploy: $(git log -1 --format='%cd' --date=short 2>/dev/null || echo 'Unknown')"
echo ""

# Quick start commands
echo "âš¡ QUICK COMMANDS:"
echo "Start all: npm run dev"
echo "Frontend only: npm run dev:frontend" 
echo "Backend only: npm run dev:backend"
echo "Build: npm run build"
echo "Deploy: npm run deploy"
echo ""

# Update status file
echo "$(date): Status checked from $(pwd)" >> /Users/Danallovertheplace/crypto-campaign-unified/.status-log